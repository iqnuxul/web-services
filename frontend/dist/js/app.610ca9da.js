(function(){"use strict";var e={2152:function(e,t,l){var a=l(5130),o=l(6768);function n(e,t,l,n,r,i){const s=(0,o.g2)("v-list-item"),d=(0,o.g2)("v-list"),c=(0,o.g2)("v-divider"),u=(0,o.g2)("v-navigation-drawer"),m=(0,o.g2)("router-view"),h=(0,o.g2)("v-main"),p=(0,o.g2)("Login"),v=(0,o.g2)("v-dialog"),g=(0,o.g2)("ConfirmationDialog"),k=(0,o.g2)("UploadFile"),f=(0,o.g2)("v-app");return(0,o.uX)(),(0,o.Wv)(f,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,{"expand-on-hover":"",rail:"",permanent:"",modelValue:r.showNavigation,"onUpdate:modelValue":t[2]||(t[2]=e=>r.showNavigation=e)},{default:(0,o.k6)((()=>[(0,o.bF)(d,{density:"compact",nav:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.navigation,(t=>(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{key:t.title,href:t.href,"prepend-icon":t.icon,title:t.title,exact:""},null,8,["href","prepend-icon","title"])),[[a.aG,e.checkIfInRole(r.user,t.roles)]]))),128))])),_:1}),(0,o.bF)(c),r.user.username?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(s,{"prepend-avatar":"/uploads/"+r.user.username+".jpg?"+r.cacheKey,title:r.user.username,onClick:t[0]||(t[0]=e=>r.uploadFileDialog=!0)},null,8,["prepend-avatar","title"])])),_:1})):(0,o.Q3)("",!0),(0,o.bF)(d,{density:"compact",nav:""},{default:(0,o.k6)((()=>[r.user.username?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(s,{key:"Login",onClick:i.prepareToLogin,"prepend-icon":"mdi-login",title:"Login",exact:""},null,8,["onClick"])),r.user.username?((0,o.uX)(),(0,o.Wv)(s,{key:"Logout",onClick:t[1]||(t[1]=e=>r.logoutConfirmation=!0),"prepend-icon":"mdi-logout",title:"Logout",exact:""})):(0,o.Q3)("",!0)])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(h,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{user:r.user},null,8,["user"])])),_:1}),(0,o.bF)(v,{modelValue:r.loginDialog,"onUpdate:modelValue":t[5]||(t[5]=e=>r.loginDialog=e),width:"25em"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{onCancel:t[3]||(t[3]=e=>r.loginDialog=!1),onLoginFailed:t[4]||(t[4]=e=>r.loginDialog=!1),onLoginSuccess:i.login},null,8,["onLoginSuccess"])])),_:1},8,["modelValue"]),(0,o.bF)(v,{modelValue:r.logoutConfirmation,"onUpdate:modelValue":t[7]||(t[7]=e=>r.logoutConfirmation=e),width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{question:"Are you sure to logout?",onOk:i.logout,onCancel:t[6]||(t[6]=e=>r.logoutConfirmation=!1)},null,8,["onOk"])])),_:1},8,["modelValue"]),(0,o.bF)(v,{modelValue:r.uploadFileDialog,"onUpdate:modelValue":t[8]||(t[8]=e=>r.uploadFileDialog=e),width:"25em"},{default:(0,o.k6)((()=>[(0,o.bF)(k,{user:r.user,onClose:i.closeUploadFileDialog},null,8,["user","onClose"])])),_:1},8,["modelValue"])])),_:1})}l(4114);var r={methods:{checkIfInRole(e,t){let l=[];return null==t?l.push(-1):t.forEach((t=>{e.roles&&e.roles.includes(t)&&l.push(t)})),l.length>0},defaultCoords(){return{lat:51.776792410651765,lng:19.48687875188774}},defaultColor(){return"#1F0080"}}};const i=(0,o.Lk)("span",{class:"text-h5"},"Login",-1);function s(e,t,l,a,n,r){const s=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-card-subtitle"),c=(0,o.g2)("v-text-field"),u=(0,o.g2)("v-container"),m=(0,o.g2)("v-card-text"),h=(0,o.g2)("v-spacer"),p=(0,o.g2)("v-btn"),v=(0,o.g2)("v-card-actions"),g=(0,o.g2)("v-card"),k=(0,o.g2)("v-form");return(0,o.uX)(),(0,o.Wv)(k,{modelValue:n.valid,"onUpdate:modelValue":t[3]||(t[3]=e=>n.valid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(g,null,{default:(0,o.k6)((()=>[(0,o.bF)(s,null,{default:(0,o.k6)((()=>[i])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.eW)(" Enter credentials ")])),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(c,{label:"Username",variant:"solo",modelValue:n.creds.username,"onUpdate:modelValue":t[0]||(t[0]=e=>n.creds.username=e),rules:[n.rules.required]},null,8,["modelValue","rules"]),(0,o.bF)(c,{label:"Password",type:"password",variant:"solo",modelValue:n.creds.password,"onUpdate:modelValue":t[1]||(t[1]=e=>n.creds.password=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.bF)(h),(0,o.bF)(p,{type:"submit",size:"small",color:"success",onClick:r.login,variant:"elevated",disabled:!n.valid},{default:(0,o.k6)((()=>[(0,o.eW)("Login")])),_:1},8,["onClick","disabled"]),(0,o.bF)(p,{size:"small",onClick:t[2]||(t[2]=t=>e.$emit("cancel")),variant:"elevated"},{default:(0,o.k6)((()=>[(0,o.eW)("Cancel")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}var d={name:"LoginForm",emits:["loginSuccess","loginFailed","cancel"],methods:{login(e){e.preventDefault(),fetch("/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.creds)}).then((e=>e.json())).then((e=>this.$emit("loginSuccess",e))).catch((()=>this.emit("loginFailed")))}},data(){return{valid:!1,rules:{required:e=>!!e||"empty value is not allowed"},creds:{}}}},c=l(1241);const u=(0,c.A)(d,[["render",s]]);var m=u,h=l(4232);function p(e,t,l,a,n,r){const i=(0,o.g2)("v-card-text"),s=(0,o.g2)("v-spacer"),d=(0,o.g2)("v-btn"),c=(0,o.g2)("v-card-actions"),u=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(l.question),1)])),_:1}),(0,o.bF)(c,{class:"actions"},{default:(0,o.k6)((()=>[(0,o.bF)(s),(0,o.bF)(d,{variant:"elevated",color:"success",onClick:t[0]||(t[0]=t=>e.$emit("ok"))},{default:(0,o.k6)((()=>[(0,o.eW)("Ok")])),_:1}),(0,o.bF)(d,{variant:"elevated",color:"warning",onClick:t[1]||(t[1]=t=>e.$emit("cancel"))},{default:(0,o.k6)((()=>[(0,o.eW)("Cancel")])),_:1})])),_:1})])),_:1})])}var v={name:"ConfirmationDialog",props:["question"],emits:["ok","cancel"]};const g=(0,c.A)(v,[["render",p]]);var k=g;function f(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("file-pond"),d=(0,o.g2)("v-card-text"),c=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(c,{"prepend-avatar":"/uploads/"+l.user.username+".jpg?"+e.cacheKey},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)(" Upload avatar ")])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(s,{ref:"pond",name:"image","label-idle":"Drop files here or click to browse...","allow-multiple":!1,"allow-revert":!1,"allow-process":!1,"accepted-file-types":"image/jpeg, image/png",server:"/files",files:e.files,onProcessfile:r.fileProcessed,onError:console.log,credits:""},null,8,["files","onProcessfile","onError"])])),_:1})])),_:1},8,["prepend-avatar"])])}var b=l(3123),F=l.n(b),V=l(751),C=l.n(V),_=l(4403),y=l.n(_);const j=F()(C(),y());var E={name:"UploadFile",components:{FilePond:j},props:["user"],data:function(){return{files:[],cacheKey:Date.now()}},methods:{fileProcessed(){this.$emit("close")}}};const w=(0,c.A)(E,[["render",f]]);var D=w,L={name:"App",components:{Login:m,ConfirmationDialog:k,UploadFile:D},mixins:[r],data(){return{navigation:[{title:"Dashboard",icon:"mdi-view-dashboard",href:"#/"},{title:"Persons",icon:"mdi-account-multiple",href:"#/persons",roles:[0,1]},{title:"Projects",icon:"mdi-sitemap-outline",href:"#/projects"},{title:"Tasks",icon:"mdi-sitemap-outline",href:"#/tasks",roles:[1]},{title:"Map",icon:"mdi-map",href:"#/map"},{title:"Chat",icon:"mdi-chat-processing-outline",href:"#/chat"}],showNavigation:!1,user:{},loginDialog:!1,logoutConfirmation:!1,uploadFileDialog:!1,cacheKey:Date.now()}},methods:{setUser(e){this.loginDialog=!1,Object.keys(this.user).forEach((e=>delete this.user[e])),Object.assign(this.user,e),this.$router.push("/"),this.showNavigation=!0},logout(){this.logoutConfirmation=!1,this.showNavigation=!1,fetch("/auth",{method:"DELETE"}).then((e=>e.json())).then((e=>this.setUser(e)))},prepareToLogin(){this.showNavigation=!1,this.loginDialog=!0},login(e){this.loginDialog=!1,this.setUser(e)},closeUploadFileDialog(){this.uploadFileDialog=!1,this.cacheKey=Date.now()}},mounted(){fetch("/auth",{method:"GET"}).then((e=>e.json())).then((e=>this.setUser(e)))}};const T=(0,c.A)(L,[["render",n]]);var I=T,W=(l(5524),l(9666)),x=l(5469),P=l(3739),U=l(1387);function S(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("ProjectChart"),d=(0,o.g2)("v-col"),c=(0,o.g2)("PersonChart"),u=(0,o.g2)("v-row"),m=(0,o.g2)("v-card-text"),h=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(h,{variant:"text"},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)("Dashboard")])),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(d,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(s)])),_:1}),(0,o.bF)(d,{cols:"6"},{default:(0,o.k6)((()=>[e.checkIfInRole(l.user,[1])?((0,o.uX)(),(0,o.Wv)(c,{key:0})):(0,o.Q3)("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}function O(e,t,l,a,n,r){const i=(0,o.g2)("ApexChart");return(0,o.uX)(),(0,o.CE)("div",null,[n.ready?((0,o.uX)(),(0,o.Wv)(i,{key:0,options:n.chartOptions,series:n.series},null,8,["options","series"])):(0,o.Q3)("",!0)])}var N=l(1758),A={name:"ProjectChart",components:{ApexChart:N.A},data(){return{ready:!1,chartOptions:{chart:{type:"donut"},labels:[],fill:{type:"gradient"}},series:[]}},mounted(){fetch("/project?limit=1000",{method:"GET"}).then((e=>{e.json().then((e=>{this.series=e.map((e=>e.members)),this.chartOptions.labels=e.map((e=>e.name)),this.ready=!0})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))}};const X=(0,c.A)(A,[["render",O]]);var M=X;function R(e,t,l,a,n,r){const i=(0,o.g2)("ApexChart");return(0,o.uX)(),(0,o.CE)("div",null,[n.ready?((0,o.uX)(),(0,o.Wv)(i,{key:0,options:n.chartOptions,series:n.series},null,8,["options","series"])):(0,o.Q3)("",!0)])}var $={name:"PersonChart",components:{ApexChart:N.A},data(){return{ready:!1,chartOptions:{chart:{type:"bar"},labels:[],fill:{type:"gradient"}},series:[{name:"Projects",data:[]}]}},mounted(){fetch("/person?minProjects=1&limit=10",{method:"GET"}).then((e=>{e.json().then((e=>{this.series[0].data=e.map((e=>e.projects.length)),this.chartOptions.labels=e.map((e=>e.firstName+" "+e.lastName)),this.ready=!0})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))}};const q=(0,c.A)($,[["render",R]]);var Q=q,G={name:"DashboardView",components:{ProjectChart:M,PersonChart:Q},mixins:[r],props:["user"]};const K=(0,c.A)(G,[["render",S]]);var J=K;const z={key:0},B=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"text-left"}," First name "),(0,o.Lk)("th",{class:"text-left"}," Last name "),(0,o.Lk)("th",{class:"text-right"}," Birth date "),(0,o.Lk)("th",{class:"text-left"}," Education "),(0,o.Lk)("th",{class:"text-left"}," Projects ")])],-1),Z=["onClick"],H={class:"text-right"};function Y(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("v-text-field"),d=(0,o.g2)("v-col"),c=(0,o.g2)("v-select"),u=(0,o.g2)("v-row"),m=(0,o.g2)("v-container"),p=(0,o.g2)("v-card-subtitle"),v=(0,o.g2)("v-chip"),g=(0,o.g2)("v-table"),k=(0,o.g2)("v-card-text"),f=(0,o.g2)("v-spacer"),b=(0,o.g2)("v-btn"),F=(0,o.g2)("v-card-actions"),V=(0,o.g2)("v-card"),C=(0,o.g2)("PersonEditor"),_=(0,o.g2)("v-dialog");return e.checkIfInRole(l.user,[0,1])?((0,o.uX)(),(0,o.CE)("div",z,[(0,o.bF)(V,{variant:"text"},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)("Persons")])),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",label:"Search",modelValue:n.search,"onUpdate:modelValue":t[0]||(t[0]=e=>n.search=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1}),(0,o.bF)(d,{cols:"3"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{modelValue:n.education,"onUpdate:modelValue":[t[1]||(t[1]=e=>n.education=e),r.retrieve],label:"Education",items:[{value:0,title:"primary"},{value:1,title:"secondary"},{value:2,title:"high"}],chips:"",multiple:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,o.bF)(d,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",type:"number",label:"Skip",modelValue:n.skip,"onUpdate:modelValue":t[2]||(t[2]=e=>n.skip=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1}),(0,o.bF)(d,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",type:"number",label:"Limit",modelValue:n.limit,"onUpdate:modelValue":t[3]||(t[3]=e=>n.limit=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(g,{density:"compact",hover:""},{default:(0,o.k6)((()=>[B,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.persons,((t,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:a,onClick:a=>e.checkIfInRole(l.user,[1])&&r.click(t)},[(0,o.Lk)("td",null,(0,h.v_)(t.firstName),1),(0,o.Lk)("td",null,(0,h.v_)(t.lastName),1),(0,o.Lk)("td",H,(0,h.v_)(new Date(t.birthDate).toLocaleDateString()),1),(0,o.Lk)("td",null,[(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(["primary","secondary","high"][t.education]),1)])),_:2},1024)]),(0,o.Lk)("td",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.projects,((e,t)=>((0,o.uX)(),(0,o.Wv)(v,{color:e.color,key:t},{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(e.shortcut),1)])),_:2},1032,["color"])))),128))])],8,Z)))),128))])])),_:1})])),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(f),e.checkIfInRole(l.user,[1])?((0,o.uX)(),(0,o.Wv)(b,{key:0,variant:"elevated",color:"success",onClick:r.add},{default:(0,o.k6)((()=>[(0,o.eW)("Add")])),_:1},8,["onClick"])):(0,o.Q3)("",!0)])),_:1})])),_:1}),(0,o.bF)(_,{modelValue:n.editor,"onUpdate:modelValue":t[4]||(t[4]=e=>n.editor=e),width:"50%"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{id:n.id,onDataChanged:r.retrieve,onCancel:r.cancel},null,8,["id","onDataChanged","onCancel"])])),_:1},8,["modelValue"])])):(0,o.Q3)("",!0)}function ee(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("v-text-field"),d=(0,o.g2)("v-radio"),c=(0,o.g2)("v-radio-group"),u=(0,o.g2)("v-select"),m=(0,o.g2)("v-form"),p=(0,o.g2)("v-card-text"),v=(0,o.g2)("v-spacer"),g=(0,o.g2)("v-btn"),k=(0,o.g2)("v-card-actions"),f=(0,o.g2)("v-card"),b=(0,o.g2)("ConfirmationDialog"),F=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(f,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(l.id?"Edit":"Create")+" person",1)])),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:n.isPersonValid,"onUpdate:modelValue":t[5]||(t[5]=e=>n.isPersonValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",label:"First name",modelValue:n.person.firstName,"onUpdate:modelValue":t[0]||(t[0]=e=>n.person.firstName=e),rules:[n.rules.required]},null,8,["modelValue","rules"]),(0,o.bF)(s,{variant:"solo",label:"Last name",modelValue:n.person.lastName,"onUpdate:modelValue":t[1]||(t[1]=e=>n.person.lastName=e),rules:[n.rules.required]},null,8,["modelValue","rules"]),(0,o.bF)(s,{variant:"solo",type:"date",label:"Birth date",modelValue:n.person.birthDate,"onUpdate:modelValue":t[2]||(t[2]=e=>n.person.birthDate=e),rules:[n.rules.validBirthDate]},null,8,["modelValue","rules"]),(0,o.bF)(c,{label:"Education",modelValue:n.person.education,"onUpdate:modelValue":t[3]||(t[3]=e=>n.person.education=e),inline:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,{value:0,label:"primary"}),(0,o.bF)(d,{value:1,label:"secondary"}),(0,o.bF)(d,{value:2,label:"high"})])),_:1},8,["modelValue"]),(0,o.bF)(u,{modelValue:n.person.projects,"onUpdate:modelValue":t[4]||(t[4]=e=>n.person.projects=e),label:"Projects",items:n.projects.map((e=>({value:e._id,title:e.shortcut,props:{subtitle:e.name+" "+e.startDate.slice(0,10)}}))),chips:"",multiple:""},null,8,["modelValue","items"])])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(v),l.id?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(g,{key:0,variant:"elevated",color:"success",onClick:r.add,disabled:!n.isPersonValid},{default:(0,o.k6)((()=>[(0,o.eW)("Add")])),_:1},8,["onClick","disabled"])),l.id?((0,o.uX)(),(0,o.Wv)(g,{key:1,variant:"elevated",color:"success",onClick:r.modify,disabled:!n.isPersonValid},{default:(0,o.k6)((()=>[(0,o.eW)("Modify")])),_:1},8,["onClick","disabled"])):(0,o.Q3)("",!0),l.id?((0,o.uX)(),(0,o.Wv)(g,{key:2,variant:"elevated",color:"error",onClick:r.remove},{default:(0,o.k6)((()=>[(0,o.eW)("Remove")])),_:1},8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(g,{variant:"elevated",color:"warning",onClick:r.cancel},{default:(0,o.k6)((()=>[(0,o.eW)("Cancel")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(F,{modelValue:n.confirmation,"onUpdate:modelValue":t[7]||(t[7]=e=>n.confirmation=e),width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(b,{question:"Are you sure to delete '"+n.person.firstName+" "+n.person.lastName+"' ?",onOk:r.removeReal,onCancel:t[6]||(t[6]=e=>n.confirmation=!1)},null,8,["question","onOk"])])),_:1},8,["modelValue"])])}var te={name:"PersonEditor",props:["id"],components:{ConfirmationDialog:k},emits:["cancel","dataChanged"],methods:{add(){fetch("/person",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.person)}).then((e=>{e.json().then((()=>{this.$emit("dataChanged")})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},modify(){fetch("/person?_id="+this.id,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.person)}).then((e=>{e.json().then((()=>{this.$emit("dataChanged")})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},remove(){this.confirmation=!0},removeReal(){this.confirmation=!1,fetch("/person?_id="+this.id,{method:"DELETE"}).then((e=>{e.json().then((()=>{this.$emit("dataChanged")})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},cancel(){this.$emit("cancel")}},data(){return{isPersonValid:!1,rules:{required:e=>!!e||"empty value is not allowed",validBirthDate:e=>!isNaN(new Date(e))||"valid date required"},person:{},dialog:!1,confirmation:!1,projects:[]}},mounted(){fetch("/project?limit=1000",{method:"GET"}).then((e=>e.json())).then((e=>this.projects=e)),this.id?fetch("/person?_id="+this.id,{method:"GET"}).then((e=>{e.json().then((e=>{Object.assign(this.person,e)})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message))):this.person={birthDate:(new Date).toISOString().slice(0,10),education:0}}};const le=(0,c.A)(te,[["render",ee]]);var ae=le,oe={name:"PersonsLister",components:{PersonEditor:ae},props:["user"],mixins:[r],methods:{retrieve(){this.id=null,this.editor=!1,fetch("/person?search="+this.search+"&education="+JSON.stringify(this.education)+"&skip="+this.skip+"&limit="+this.limit,{method:"GET"}).then((e=>{e.json().then((e=>{this.persons=e})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},add(){this.id=null,this.editor=!0},click(e){this.id=e._id,this.editor=!0},cancel(){this.id=null,this.editor=!1}},data(){return{editor:!1,persons:[],id:null,search:"",education:[0,1,2],skip:0,limit:10}},mounted(){this.retrieve()}};const ne=(0,c.A)(oe,[["render",Y]]);var re=ne;const ie=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"text-left"}," Name "),(0,o.Lk)("th",{class:"text-left"}," Shortcut "),(0,o.Lk)("th",{class:"text-right"}," Start date "),(0,o.Lk)("th",{class:"text-right"}," Members ")])],-1),se=["onClick"],de={class:"text-right"},ce={class:"text-right"};function ue(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("v-text-field"),d=(0,o.g2)("v-col"),c=(0,o.g2)("v-row"),u=(0,o.g2)("v-container"),m=(0,o.g2)("v-card-subtitle"),p=(0,o.g2)("v-chip"),v=(0,o.g2)("v-table"),g=(0,o.g2)("v-card-text"),k=(0,o.g2)("v-spacer"),f=(0,o.g2)("v-btn"),b=(0,o.g2)("v-card-actions"),F=(0,o.g2)("v-card"),V=(0,o.g2)("ProjectEditor"),C=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(F,{variant:"text"},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)("Projects")])),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",label:"Search",modelValue:n.search,"onUpdate:modelValue":t[0]||(t[0]=e=>n.search=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1}),(0,o.bF)(d,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",type:"number",label:"Skip",modelValue:n.skip,"onUpdate:modelValue":t[1]||(t[1]=e=>n.skip=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1}),(0,o.bF)(d,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",type:"number",label:"Limit",modelValue:n.limit,"onUpdate:modelValue":t[2]||(t[2]=e=>n.limit=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(g,null,{default:(0,o.k6)((()=>[(0,o.bF)(v,{density:"compact",hover:""},{default:(0,o.k6)((()=>[ie,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.projects,((t,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:a,onClick:a=>e.checkIfInRole(l.user,[1])&&r.click(t)},[(0,o.Lk)("td",null,(0,h.v_)(t.name),1),(0,o.Lk)("td",null,[(0,o.bF)(p,{color:t.color},{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(t.shortcut),1)])),_:2},1032,["color"])]),(0,o.Lk)("td",de,(0,h.v_)(new Date(t.startDate).toLocaleDateString()),1),(0,o.Lk)("td",ce,(0,h.v_)(t.members),1)],8,se)))),128))])])),_:1})])),_:1}),(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.bF)(k),e.checkIfInRole(l.user,[1])?((0,o.uX)(),(0,o.Wv)(f,{key:0,variant:"elevated",color:"success",onClick:r.add},{default:(0,o.k6)((()=>[(0,o.eW)("Add")])),_:1},8,["onClick"])):(0,o.Q3)("",!0)])),_:1})])),_:1}),(0,o.bF)(C,{modelValue:n.editor,"onUpdate:modelValue":t[3]||(t[3]=e=>n.editor=e),width:"50%"},{default:(0,o.k6)((()=>[(0,o.bF)(V,{id:n.id,onDataChanged:r.retrieve,onCancel:r.cancel},null,8,["id","onDataChanged","onCancel"])])),_:1},8,["modelValue"])])}const me={class:"flex-container"},he={class:"flex-container"};function pe(e,t,a,n,r,i){const s=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-text-field"),c=(0,o.g2)("v-color-picker"),u=(0,o.g2)("v-btn"),m=(0,o.g2)("VMapIconMarker"),p=(0,o.g2)("VMapGoogleTileLayer"),v=(0,o.g2)("VMapZoomControl"),g=(0,o.g2)("VMap"),k=(0,o.g2)("v-form"),f=(0,o.g2)("v-card-text"),b=(0,o.g2)("v-spacer"),F=(0,o.g2)("v-card-actions"),V=(0,o.g2)("v-card"),C=(0,o.g2)("ConfirmationDialog"),_=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(s,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(a.id?"Edit":"Create")+" project",1)])),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)((()=>[(0,o.bF)(k,{modelValue:r.isProjectValid,"onUpdate:modelValue":t[5]||(t[5]=e=>r.isProjectValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(d,{variant:"solo",label:"Name",modelValue:r.project.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.project.name=e),rules:[r.rules.required]},null,8,["modelValue","rules"]),(0,o.Lk)("div",me,[(0,o.bF)(d,{variant:"solo",label:"Shortcut",modelValue:r.project.shortcut,"onUpdate:modelValue":t[1]||(t[1]=e=>r.project.shortcut=e),rules:[r.rules.required]},null,8,["modelValue","rules"]),(0,o.bF)(c,{mode:"rgb",modelValue:r.project.color,"onUpdate:modelValue":t[2]||(t[2]=e=>r.project.color=e),"hide-canvas":"","hide-inputs":""},null,8,["modelValue"])]),(0,o.bF)(d,{variant:"solo",type:"date",label:"Start date",modelValue:r.project.startDate,"onUpdate:modelValue":t[3]||(t[3]=e=>r.project.startDate=e),rules:[r.rules.validStartDate]},null,8,["modelValue","rules"]),(0,o.Lk)("div",he,[(0,o.bF)(u,{variant:"text",size:"xx-small",rounded:"false",icon:"mdi-image-filter-center-focus",onClick:i.centerView},null,8,["onClick"]),(0,o.eW)(" Location (click or drag to set) ")]),(0,o.bF)(g,{ref:"vmap",style:{height:"200px"},center:r.center,zoom:"15",onClick:i.setMarker},{default:(0,o.k6)((()=>[(0,o.bF)(m,{ref:"vmarker",latlng:r.project.coords,"onUpdate:latlng":t[4]||(t[4]=e=>r.project.coords=e),"icon-url":l(7024),"icon-retina-url":l(8249),"icon-shadow-url":l(1071),"icon-size":[28,46],"icon-anchor":[17,46],draggable:""},null,8,["latlng","icon-url","icon-retina-url","icon-shadow-url"]),(0,o.bF)(p),(0,o.bF)(v)])),_:1},8,["center","onClick"])])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(b),a.id?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(u,{key:0,variant:"elevated",color:"success",onClick:i.add,disabled:!r.isProjectValid},{default:(0,o.k6)((()=>[(0,o.eW)("Add")])),_:1},8,["onClick","disabled"])),a.id?((0,o.uX)(),(0,o.Wv)(u,{key:1,variant:"elevated",color:"success",onClick:i.modify,disabled:!r.isProjectValid},{default:(0,o.k6)((()=>[(0,o.eW)("Modify")])),_:1},8,["onClick","disabled"])):(0,o.Q3)("",!0),a.id?((0,o.uX)(),(0,o.Wv)(u,{key:2,variant:"elevated",color:"error",onClick:i.remove},{default:(0,o.k6)((()=>[(0,o.eW)("Remove")])),_:1},8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(u,{variant:"elevated",color:"warning",onClick:i.cancel},{default:(0,o.k6)((()=>[(0,o.eW)("Cancel")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(_,{modelValue:r.confirmation,"onUpdate:modelValue":t[7]||(t[7]=e=>r.confirmation=e),width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{question:"Are you sure to delete '"+r.project.name+"' ?",onOk:i.removeReal,onCancel:t[6]||(t[6]=e=>r.confirmation=!1)},null,8,["question","onOk"])])),_:1},8,["modelValue"])])}var ve=l(1629),ge={name:"ProjectEditor",props:["id"],components:{ConfirmationDialog:k,VMap:ve.P5,VMapGoogleTileLayer:ve.Dy,VMapZoomControl:ve.De,VMapIconMarker:ve.Qw},emits:["cancel","dataChanged","dataAccessFailed"],mixins:[r],methods:{add(){fetch("/project",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.project)}).then((e=>e.json())).then((e=>{if(e.error)throw new Error(e.error);this.$emit("dataChanged")})).catch((e=>this.$emit("dataAccessFailed",e.message)))},modify(){fetch("/project?_id="+this.id,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.project)}).then((e=>e.json())).then((e=>{if(e.error)throw new Error(e.error);this.$emit("dataChanged")})).catch((e=>this.$emit("dataAccessFailed",e.message)))},remove(){this.confirmation=!0},removeReal(){this.confirmation=!1,fetch("/project?_id="+this.id,{method:"DELETE"}).then((e=>e.json())).then((e=>{if(e.error)throw new Error(e.error);this.$emit("dataChanged")})).catch((e=>this.$emit("dataAccessFailed",e.message)))},cancel(){this.$emit("cancel")},setMarker(e){this.project.coords=e.latlng},centerView(){this.center=this.project.coords,this.$refs.vmap.map.flyTo(this.center)}},data(){return{isProjectValid:!1,rules:{required:e=>!!e||"empty value is not allowed",validStartDate:e=>!isNaN(new Date(e))||"valid date required"},project:{color:this.defaultColor(),coords:this.defaultCoords()},center:this.defaultCoords(),dialog:!1,confirmation:!1,ready:!1}},mounted(){this.id&&fetch("/project?_id="+this.id,{method:"GET"}).then((e=>e.json())).then((e=>{if(e.error)throw new Error(e.error);e.coords||(e.coords=this.defaultCoords()),Object.assign(this.project,e),console.log(e),Object.assign(this.center,this.project.coords),this.$refs.vmap.map.panTo(this.center)})).catch((e=>console.log(e.message)))}};const ke=(0,c.A)(ge,[["render",pe],["__scopeId","data-v-020b4b22"]]);var fe=ke,be={name:"ProjectsLister",components:{ProjectEditor:fe},mixins:[r],props:["user"],methods:{retrieve(){this.id=null,this.editor=!1,fetch("/project?search="+this.search+"&skip="+this.skip+"&limit="+this.limit,{method:"GET"}).then((e=>{e.json().then((e=>{this.projects=e})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},add(){this.id=null,this.editor=!0},click(e){this.id=e._id,this.editor=!0},cancel(){this.id=null,this.editor=!1}},data(){return{editor:!1,projects:[],id:null,search:"",skip:0,limit:10}},mounted(){this.retrieve()}};const Fe=(0,c.A)(be,[["render",ue]]);var Ve=Fe;const Ce={key:0},_e={key:0};function ye(e,t,a,n,r,i){const s=(0,o.g2)("v-select"),d=(0,o.g2)("VMapIconMarker"),c=(0,o.g2)("VMapGoogleTileLayer"),u=(0,o.g2)("VMapZoomControl"),m=(0,o.g2)("VMap"),p=(0,o.g2)("v-snackbar");return r.markers.length>0?((0,o.uX)(),(0,o.CE)("div",Ce,[(0,o.bF)(s,{variant:"solo",label:"Project",modelValue:r.selected,"onUpdate:modelValue":[t[0]||(t[0]=e=>r.selected=e),i.selectProject],items:r.markers.map(((e,t)=>({value:t,title:e.title})))},null,8,["modelValue","items","onUpdate:modelValue"]),(0,o.bF)(m,{ref:"vmap",style:{height:"700px"},center:r.center,zoom:r.zoom,onViewChanged:i.onViewChanged},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.markers,((e,t)=>((0,o.uX)(),(0,o.Wv)(d,{key:t,ref_for:!0,ref:"vmarker",latlng:r.markers[t],"onUpdate:latlng":e=>r.markers[t]=e,"icon-url":l(7024),"icon-retina-url":l(8249),"icon-shadow-url":l(1071),"icon-size":[28,46],"icon-anchor":[17,46],opacity:t==r.selected?1:.5,onMousedown:l=>i.onMarkerClick(e,t)},null,8,["latlng","onUpdate:latlng","icon-url","icon-retina-url","icon-shadow-url","opacity","onMousedown"])))),128)),(0,o.bF)(c),(0,o.bF)(u)])),_:1},8,["center","zoom","onViewChanged"]),0==r.markers.length?((0,o.uX)(),(0,o.CE)("div",_e," No projects ")):(0,o.Q3)("",!0),(0,o.bF)(p,{modelValue:r.dataAccessError,"onUpdate:modelValue":t[1]||(t[1]=e=>r.dataAccessError=e),color:"error",timeout:"3000"},{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(r.dataAccessErrorMsg),1)])),_:1},8,["modelValue"])])):(0,o.Q3)("",!0)}var je={name:"ProjectsMap",components:{VMap:ve.P5,VMapGoogleTileLayer:ve.Dy,VMapZoomControl:ve.De,VMapIconMarker:ve.Qw},mixins:[r],data(){return{center:this.defaultCoords(),zoom:12,markers:[],selected:0,dataAccessError:!1,dataAccessErrorMsg:""}},methods:{selectProject(){this.center={lat:this.markers[this.selected].lat,lng:this.markers[this.selected].lng},this.$refs.vmap.map.flyTo(this.center)},onMarkerClick(e,t){this.selected=t,this.selectProject()},onViewChanged(e){this.center=e.center},onDataAccessFailed(e){this.dataAccessErrorMsg=e,this.dataAccessError=!0}},mounted(){fetch("/project?limit=1000",{method:"GET"}).then((e=>e.json())).then((e=>{if(e.error)throw new Error(e.error);this.markers=e.map((e=>({title:e.name,lat:e.coords.lat||this.defaultCoords().lat,lng:e.coords.lng||this.defaultCoords().lng}))),this.markers.length&&(this.center=this.markers[0])})).catch((e=>console.log(e.message)))}};const Ee=(0,c.A)(je,[["render",ye]]);var we=Ee;function De(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("v-list-item"),d=(0,o.g2)("v-list"),c=(0,o.g2)("v-card-text"),u=(0,o.g2)("v-text-field"),m=(0,o.g2)("v-col"),p=(0,o.g2)("v-btn"),v=(0,o.g2)("v-form"),g=(0,o.g2)("v-row"),k=(0,o.g2)("v-card-actions"),f=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(f,{variant:"text"},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)("Chat")])),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.history,((e,t)=>((0,o.uX)(),(0,o.Wv)(s,{key:t,subtitle:(e.sender||"not-logged-in")+" "+e.timestamp.toLocaleTimeString(),class:(0,h.C4)((e.sender==l.user.username?"my-message":"foreign-message")+" "+(e.recipient?"unicast":"broadcast"))},{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(e.message),1)])),_:2},1032,["subtitle","class"])))),128))])),_:1})])),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(g,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{cols:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{variant:"solo",label:"Recipient",modelValue:n.recipient,"onUpdate:modelValue":t[0]||(t[0]=e=>n.recipient=e)},null,8,["modelValue"])])),_:1}),(0,o.bF)(m,{cols:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{ref:"messageinput",modelValue:n.valid,"onUpdate:modelValue":t[2]||(t[2]=e=>n.valid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(u,{variant:"solo",label:"Message",modelValue:n.message,"onUpdate:modelValue":t[1]||(t[1]=e=>n.message=e),rules:[n.rules.required]},{"append-inner":(0,o.k6)((()=>[(0,o.bF)(p,{type:"submit",variant:"elevated",color:"success",onClick:r.send,disabled:!n.valid},{default:(0,o.k6)((()=>[(0,o.eW)("Send")])),_:1},8,["onClick","disabled"])])),_:1},8,["modelValue","rules"])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})}var Le={name:"ChatView",props:["user"],data(){return{connection:null,message:"",recipient:"",history:[],valid:!1,rules:{required:e=>!!e||"empty message cannot be sent"}}},methods:{send(){let e={event:"CHAT",message:this.message};this.recipient&&(e.recipient=this.recipient),this.connection.send(JSON.stringify(e)),this.$refs.messageinput.reset()}},mounted(){this.connection=new WebSocket("ws://"+window.location.host+"/websocket"),this.connection.onopen=()=>{console.log("Websocket connection established"),setTimeout((()=>this.connection.send(JSON.stringify({event:"INIT",session:this.user.sessionid||null}))),500)},this.connection.onmessage=e=>{let t={};try{t=JSON.parse(e.data),t.timestamp=new Date(t.timestamp)}catch(l){return void console.error("Broken WS data",e.data)}switch(console.log("WS data arrived"),t.event){case"CHAT":this.history.push(t);break}}}};const Te=(0,c.A)(Le,[["render",De],["__scopeId","data-v-1b6187ec"]]);var Ie=Te;const We={key:0},xe=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"text-left"},"name"),(0,o.Lk)("th",{class:"text-left"},"project"),(0,o.Lk)("th",{class:"text-left"},"status"),(0,o.Lk)("th",{class:"text-left"},"workers"),(0,o.Lk)("th",{class:"text-left"},"Start date"),(0,o.Lk)("th",{class:"text-left"},"End date")])],-1),Pe=["onClick"];function Ue(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("v-text-field"),d=(0,o.g2)("v-col"),c=(0,o.g2)("v-select"),u=(0,o.g2)("v-row"),m=(0,o.g2)("v-container"),p=(0,o.g2)("v-card-subtitle"),v=(0,o.g2)("v-chip"),g=(0,o.g2)("v-table"),k=(0,o.g2)("v-card-text"),f=(0,o.g2)("v-spacer"),b=(0,o.g2)("v-btn"),F=(0,o.g2)("v-card-actions"),V=(0,o.g2)("v-card"),C=(0,o.g2)("TaskEditor"),_=(0,o.g2)("v-dialog");return e.checkIfInRole(l.user,[1])?((0,o.uX)(),(0,o.CE)("div",We,[(0,o.bF)(V,{variant:"text"},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)("Tasks")])),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",label:"Search",modelValue:n.search,"onUpdate:modelValue":t[0]||(t[0]=e=>n.search=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1}),(0,o.bF)(d,{cols:"3"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{modelValue:n.project,"onUpdate:modelValue":[t[1]||(t[1]=e=>n.project=e),r.retrieve],label:"project",items:n.projects},null,8,["modelValue","items","onUpdate:modelValue"])])),_:1}),(0,o.bF)(d,{cols:"3"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{modelValue:n.status,"onUpdate:modelValue":[t[2]||(t[2]=e=>n.status=e),r.retrieve],label:"status",items:[{value:0,title:"PREPARATION"},{value:1,title:"PENDING"},{value:2,title:"IN TESTS"},{value:3,title:"COMPLETED"}],chips:"",multiple:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,o.bF)(d,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",type:"number",label:"Limit",modelValue:n.limit,"onUpdate:modelValue":t[3]||(t[3]=e=>n.limit=e),onInput:r.retrieve},null,8,["modelValue","onInput"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(g,{density:"compact",hover:""},{default:(0,o.k6)((()=>[xe,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.tasks,((t,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:a,onClick:a=>e.checkIfInRole(l.user,[1])&&r.click(t)},[(0,o.Lk)("td",null,(0,h.v_)(t.name),1),(0,o.Lk)("td",null,(0,h.v_)(t.project?t.project.name:""),1),(0,o.Lk)("td",null,[(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(["PREPARATION","PENDING","IN TESTS","COMPLETED"][t.status]),1)])),_:2},1024)]),(0,o.Lk)("td",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.workers,((e,t)=>((0,o.uX)(),(0,o.Wv)(v,{key:t},{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(e.firstName)+" "+(0,h.v_)(e.lastName),1)])),_:2},1024)))),128))]),(0,o.Lk)("td",null,(0,h.v_)(new Date(t.startDate).toLocaleDateString()),1),(0,o.Lk)("td",null,(0,h.v_)(new Date(t.endDate).toLocaleDateString()),1)],8,Pe)))),128))])])),_:1})])),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(f),e.checkIfInRole(l.user,[1])?((0,o.uX)(),(0,o.Wv)(b,{key:0,variant:"elevated",color:"success",onClick:r.add},{default:(0,o.k6)((()=>[(0,o.eW)("Add")])),_:1},8,["onClick"])):(0,o.Q3)("",!0)])),_:1})])),_:1}),(0,o.bF)(_,{modelValue:n.editor,"onUpdate:modelValue":t[4]||(t[4]=e=>n.editor=e),width:"50%"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{id:n.id,projectId:n.project,onDataChanged:r.retrieve,onCancel:r.cancel},null,8,["id","projectId","onDataChanged","onCancel"])])),_:1},8,["modelValue"])])):(0,o.Q3)("",!0)}function Se(e,t,l,a,n,r){const i=(0,o.g2)("v-card-title"),s=(0,o.g2)("v-text-field"),d=(0,o.g2)("v-select"),c=(0,o.g2)("v-radio"),u=(0,o.g2)("v-radio-group"),m=(0,o.g2)("v-form"),p=(0,o.g2)("v-card-text"),v=(0,o.g2)("v-spacer"),g=(0,o.g2)("v-btn"),k=(0,o.g2)("v-card-actions"),f=(0,o.g2)("v-card"),b=(0,o.g2)("ConfirmationDialog"),F=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(f,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,h.v_)(l.id?"Edit":"Create")+" task",1)])),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:n.isTaskValid,"onUpdate:modelValue":t[6]||(t[6]=e=>n.isTaskValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(s,{variant:"solo",label:"Name",modelValue:n.task.name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.task.name=e),rules:[n.rules.required]},null,8,["modelValue","rules"]),(0,o.bF)(d,{modelValue:n.task.project,"onUpdate:modelValue":t[1]||(t[1]=e=>n.task.project=e),label:"Project",rules:[n.rules.required],items:n.projects.map((e=>({value:e._id,title:e.name}))),chips:"",readonly:"true"},null,8,["modelValue","rules","items"]),(0,o.bF)(u,{label:"Status",modelValue:n.task.status,"onUpdate:modelValue":t[2]||(t[2]=e=>n.task.status=e),inline:""},{default:(0,o.k6)((()=>[(0,o.bF)(c,{value:0,label:"PREPARATION"}),(0,o.bF)(c,{value:1,label:"PENDING"}),(0,o.bF)(c,{value:2,label:"IN TESTS"}),(0,o.bF)(c,{value:3,label:"COMPLETED"})])),_:1},8,["modelValue"]),(0,o.bF)(d,{modelValue:n.task.workers,"onUpdate:modelValue":t[3]||(t[3]=e=>n.task.workers=e),label:"Workers",items:n.workers.map((e=>({value:e._id,title:e.firstName+" "+e.lastName}))),chips:"",multiple:""},null,8,["modelValue","items"]),(0,o.bF)(s,{variant:"solo",type:"date",label:"Start date",modelValue:n.task.startDate,"onUpdate:modelValue":t[4]||(t[4]=e=>n.task.startDate=e),rules:[n.rules.required,n.rules.validStartDate]},null,8,["modelValue","rules"]),(0,o.bF)(s,{variant:"solo",type:"date",label:"End date",modelValue:n.task.endDate,"onUpdate:modelValue":t[5]||(t[5]=e=>n.task.endDate=e),rules:[n.rules.validStartDate]},null,8,["modelValue","rules"])])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(v),l.id?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(g,{key:0,variant:"elevated",color:"success",onClick:r.add,disabled:!n.isTaskValid},{default:(0,o.k6)((()=>[(0,o.eW)("Add")])),_:1},8,["onClick","disabled"])),l.id?((0,o.uX)(),(0,o.Wv)(g,{key:1,variant:"elevated",color:"success",onClick:r.modify,disabled:!n.isTaskValid},{default:(0,o.k6)((()=>[(0,o.eW)("Modify")])),_:1},8,["onClick","disabled"])):(0,o.Q3)("",!0),l.id?((0,o.uX)(),(0,o.Wv)(g,{key:2,variant:"elevated",color:"error",onClick:r.remove},{default:(0,o.k6)((()=>[(0,o.eW)("Remove")])),_:1},8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(g,{variant:"elevated",color:"warning",onClick:r.cancel},{default:(0,o.k6)((()=>[(0,o.eW)("Cancel")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(F,{modelValue:n.confirmation,"onUpdate:modelValue":t[8]||(t[8]=e=>n.confirmation=e),width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(b,{question:"Are you sure to delete ?",onOk:r.removeReal,onCancel:t[7]||(t[7]=e=>n.confirmation=!1)},null,8,["onOk"])])),_:1},8,["modelValue"])])}var Oe={name:"TaskEditor",props:["id","projectId"],components:{ConfirmationDialog:k},emits:["cancel","dataChanged"],methods:{add(){fetch("/task",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.task)}).then((e=>{e.json().then((()=>{this.$emit("dataChanged")})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},modify(){fetch("/task?_id="+this.id,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.task)}).then((e=>{e.json().then((()=>{this.$emit("dataChanged")})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},remove(){this.confirmation=!0},removeReal(){this.confirmation=!1,fetch("/task?_id="+this.id,{method:"DELETE"}).then((e=>{e.json().then((()=>{this.$emit("dataChanged")})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},cancel(){this.$emit("cancel")}},data(){return{isTaskValid:!1,rules:{required:e=>!!e||"empty value is not allowed",validBirthDate:e=>!isNaN(new Date(e))||"valid date required"},task:{},dialog:!1,confirmation:!1,projects:[],workers:[]}},mounted(){fetch("/project?limit=1000",{method:"GET"}).then((e=>e.json())).then((e=>this.projects=e)),fetch("/person?limit=1000",{method:"GET"}).then((e=>e.json())).then((e=>{this.workers=e.filter((e=>e.projects.includes(this.projectId)))})),this.id?fetch("/task?_id="+this.id,{method:"GET"}).then((e=>{e.json().then((e=>{Object.assign(this.task,e)})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message))):this.task={startDate:(new Date).toISOString().slice(0,10),status:0},this.projectId&&(this.task.project=this.projectId)}};const Ne=(0,c.A)(Oe,[["render",Se]]);var Ae=Ne,Xe={name:"TasksLister",components:{TaskEditor:Ae},props:["user"],mixins:[r],methods:{retrieve(){this.id=null,this.editor=!1,fetch("/task?search="+this.search+"&limit="+this.limit+"&status="+JSON.stringify(this.status)+"&project="+this.project,{method:"GET"}).then((e=>{e.json().then((e=>{this.tasks=e})).catch((e=>console.error(e.message)))})).catch((e=>console.error(e.message)))},add(){this.id=null,this.editor=!0},click(e){this.id=e._id,this.editor=!0},cancel(){this.id=null,this.editor=!1}},data(){return{editor:!1,tasks:[],id:null,search:"",limit:10,projects:[],project:"",status:[0,1,2,3]}},mounted(){fetch("/project?limit=1000",{method:"GET"}).then((e=>e.json())).then((e=>{console.log(e),Array.isArray(e)&&e.length>0&&(this.projects=e.map((e=>({value:e._id,title:e.name}))),this.project=this.projects[0].value),this.retrieve()}))}};const Me=(0,c.A)(Xe,[["render",Ue]]);var Re=Me;const $e=(0,W.$N)({ssr:!0,components:x,directives:P,icons:{iconfont:"mdi"}}),qe=(0,U.aE)({history:(0,U.Bt)(),routes:[{path:"/",component:J},{path:"/persons",component:re},{path:"/projects",component:Ve},{path:"/tasks",component:Re},{path:"/map",component:we},{path:"/chat",component:Ie}]});(0,a.Ef)(I).use($e).use(qe).mount("#app")}},t={};function l(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,l),n.exports}l.m=e,function(){var e=[];l.O=function(t,a,o,n){if(!a){var r=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],n=e[c][2];for(var i=!0,s=0;s<a.length;s++)(!1&n||r>=n)&&Object.keys(l.O).every((function(e){return l.O[e](a[s])}))?a.splice(s--,1):(i=!1,n<r&&(r=n));if(i){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,o,n]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,n,r=a[0],i=a[1],s=a[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(o in i)l.o(i,o)&&(l.m[o]=i[o]);if(s)var c=s(l)}for(t&&t(a);d<r.length;d++)n=r[d],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(c)},a=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],(function(){return l(2152)}));a=l.O(a)})();
//# sourceMappingURL=app.610ca9da.js.map